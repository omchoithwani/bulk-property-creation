<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HubSpot Bulk Property Creator</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- ── Header ─────────────────────────────────────────── -->
  <header class="app-header">
    <div class="header-inner">
      <div class="header-brand">
        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="14" cy="14" r="14" fill="#FF7A59"/>
          <path d="M9 8h2.5v5h7V8H21v12h-2.5v-5h-7v5H9V8Z" fill="white"/>
        </svg>
        <span class="brand-name">Bulk Property Creator</span>
        <span class="hs-badge">HubSpot</span>
      </div>
    </div>
  </header>

  <!-- ── Main ───────────────────────────────────────────── -->
  <main class="app-main">

    <!-- Step 1: Configuration -->
    <div class="card" id="card-config">
      <div class="card-header">
        <div class="step-label">
          <span class="step-dot">1</span>
          <div>
            <h2>Configuration</h2>
            <p>Connect your HubSpot account and choose an object type</p>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="form-grid">
          <div class="form-group">
            <label for="token">
              Private App Token <span class="req">*</span>
            </label>
            <div class="input-wrap">
              <input
                type="password"
                id="token"
                placeholder="pat-na1-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
                autocomplete="off"
              />
              <button class="eye-btn" id="eyeBtn" onclick="toggleToken()" title="Show / hide token" aria-label="Toggle token visibility">
                <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
              </button>
            </div>
            <p class="hint">
              Create a Private App in HubSpot → Settings → Integrations → Private Apps.<br/>
              Required scopes: <code>crm.schemas.&lt;object&gt;.write</code>
            </p>
          </div>
          <div class="form-group">
            <label for="objectType">
              Object Type <span class="req">*</span>
            </label>
            <select id="objectType">
              <option value="contacts">Contacts</option>
              <option value="companies">Companies</option>
              <option value="deals">Deals</option>
              <option value="tickets">Tickets</option>
              <option value="products">Products</option>
            </select>
            <p class="hint">Properties will be created under this object type.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Step 2: Upload CSV -->
    <div class="card" id="card-upload">
      <div class="card-header">
        <div class="step-label">
          <span class="step-dot">2</span>
          <div>
            <h2>Upload CSV</h2>
            <p>Upload a file with one property per row</p>
          </div>
        </div>
        <button class="btn btn-outline btn-sm" onclick="downloadTemplate()">
          <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          Download Template
        </button>
      </div>
      <div class="card-body">

        <!-- CSV format guide -->
        <div class="format-guide">
          <p class="format-title">CSV Columns</p>
          <div class="format-cols">
            <div class="format-col required-col">
              <span class="col-name">Name</span>
              <span class="col-req-tag">Required</span>
              <span class="col-desc">Display label for the property</span>
            </div>
            <div class="format-col required-col">
              <span class="col-name">Type</span>
              <span class="col-req-tag">Required</span>
              <span class="col-desc">Drop-down Select · Radio Select · Multiple Checkboxes</span>
            </div>
            <div class="format-col optional-col">
              <span class="col-name">Description</span>
              <span class="col-opt-tag">Optional</span>
              <span class="col-desc">Help text shown in HubSpot</span>
            </div>
            <div class="format-col optional-col">
              <span class="col-name">Options</span>
              <span class="col-opt-tag">Optional</span>
              <span class="col-desc">Semicolon-separated values — e.g. <em>Red;Green;Blue</em></span>
            </div>
          </div>
        </div>

        <!-- Drop zone -->
        <div
          class="dropzone"
          id="dropzone"
          ondragover="handleDragOver(event)"
          ondragleave="handleDragLeave(event)"
          ondrop="handleDrop(event)"
          onclick="document.getElementById('fileInput').click()"
        >
          <div class="dz-inner">
            <svg class="dz-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/></svg>
            <p class="dz-primary">Drag &amp; drop your CSV here</p>
            <p class="dz-secondary">or click to browse files</p>
          </div>
        </div>
        <input type="file" id="fileInput" accept=".csv" style="display:none" onchange="handleFileSelect(event)" />

        <!-- CSV errors -->
        <div id="csvErrors" class="error-box" style="display:none"></div>

        <!-- Preview -->
        <div id="csvPreview" style="display:none">
          <div class="preview-header">
            <h3 id="previewCount"></h3>
            <button class="btn btn-outline btn-sm" onclick="clearFile()">Clear</button>
          </div>
          <div class="table-wrap">
            <table id="previewTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Description</th>
                  <th>Options</th>
                </tr>
              </thead>
              <tbody id="previewBody"></tbody>
            </table>
          </div>
        </div>

      </div>
    </div>

    <!-- Step 3: Create -->
    <div class="card" id="card-create">
      <div class="card-body">

        <button class="btn btn-primary btn-lg" id="createBtn" onclick="createProperties()" disabled>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          Create Properties in HubSpot
        </button>

        <!-- Progress -->
        <div id="progressSection" style="display:none">
          <div class="progress-track">
            <div class="progress-fill" id="progressFill" style="width:0%"></div>
          </div>
          <p class="progress-text" id="progressText">Starting…</p>
        </div>

        <!-- Results -->
        <div id="resultsSection" style="display:none">
          <div class="results-summary" id="resultsSummary"></div>
          <div class="table-wrap">
            <table id="resultsTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Internal Name</th>
                  <th>Status</th>
                  <th>Details</th>
                </tr>
              </thead>
              <tbody id="resultsBody"></tbody>
            </table>
          </div>
        </div>

      </div>
    </div>

  </main>

  <script src="app.js"></script>
</body>
</html>
